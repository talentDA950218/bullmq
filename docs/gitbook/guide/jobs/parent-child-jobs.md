# Parent - Child Jobs

BullMQ supports Parent - Child relationships between jobs. The basic idea is that a parent job will only start to be processed when all its child jobs have been processed successfully. A part from that, a parent or a child job are no different from regular jobs.

{% hint style="warning" %}
Currently, parent jobs can only be created using the "addBulk" method. But new methods for managing parents will be added soon.
{% endhint %}

A parent job can be created implicitly using the "addBulk" method. This method will atomically create all the children and the parent jobs. After this call, as soon as all the children are completed, the parent job will be moved to the wait status and processed as a regular job:

```typescript
import { Queue } from 'bullmq'

const queue = new Queue('steps')

const jobs = await queue.addBulk(
  [
    { name, data: { paint: 'ceiling' } },
    { name, data: { paint: 'walls' } },
    { name, data: { fix: 'floor' } },
  ],
  {
    parent: {
      name: 'renovate-interior',
      queue: 'renovate-queue',
      data: { billingInfo: 'foobar' },
    },
  },
);
```

The above call will return instances for all the jobs added to the queue. Note that the parent queue does not need to be the same queue as the one used for the children.

When the parent job is processed it is possible to access the results generated by its child jobs. For example lets assume the following worker for the child jobs:

```typescript
import { Worker } from "bullmq"

const stepsQueue = new Worker('steps', async (job) => {
  await performStep(job.data);
  
  if(job.data.paint) {
    return 2500;
  } else if( job.data.fix ) {
    return 1750;
  }
});
```

we can implement a parent worker that sums the costs of the children's jobs using the "getChildrenValues" method:

```typescript
import { Worker } from "bullmq"

const stepsQueue = new Worker('renovate-interior', async job => {
  const childrenValues = job.getChildrenValues();

  // childrenValues is an object mapping job keys with their values

  const totalCosts = Object(childrenValues)
    .values()
    .reduce((prev, cur) => prev + cur, 0);

  await sendInvoice(totalCosts);
});
```

{% hint style="info" %}
Parent-child jobs is a pretty new feature so expect more functionality landing in BullMQ on the following months.
{% endhint %}



